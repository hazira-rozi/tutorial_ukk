<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial Proyek Rental Motor (UKK RPL 2026)</title>
    <style>
        :root {
            --primary: #4f46e5;
            --secondary: #0ea5e9;
            --bg: #f8fafc;
            --text: #334155;
            --code-bg: #1e293b;
            --code-text: #e2e8f0;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            line-height: 1.7;
            color: var(--text);
            background: var(--bg);
            margin: 0;
            padding: 0;
        }

        /* Navbar */
        nav {
            background: white;
            position: sticky;
            top: 0;
            border-bottom: 1px solid #e2e8f0;
            z-index: 100;
            padding: 0.5rem 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .nav-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo { font-weight: 800; color: var(--primary); font-size: 1.2rem; text-decoration: none; }
        
        .nav-links { display: flex; gap: 20px; list-style: none; margin: 0; padding: 0; }
        .nav-links a { text-decoration: none; color: var(--text); font-size: 0.9rem; font-weight: 500; }
        .nav-links a:hover { color: var(--primary); }

        /* Main Content */
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            padding-bottom: 4rem;
        }

        header {
            text-align: center;
            padding: 3rem 0;
            border-bottom: 2px solid #f1f5f9;
        }

        h1 { color: var(--primary); margin-bottom: 0.5rem; }
        h2 { color: #1e293b; margin-top: 3rem; border-left: 5px solid var(--secondary); padding-left: 15px; }
        h3 { color: #475569; margin-top: 2rem; }

        p { margin-bottom: 1.5rem; }

        /* Code Blocks */
        pre {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            border: 1px solid #334155;
        }

        code {
            font-family: 'Consolas', monospace;
            background: #f1f5f9;
            color: #d946ef;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.9em;
        }

        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }

        /* Components */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            background: var(--primary);
            vertical-align: middle;
            margin-right: 0.5rem;
        }

        .alert {
            background: #eff6ff;
            border-left: 4px solid var(--primary);
            padding: 1rem;
            margin: 1.5rem 0;
            border-radius: 0 4px 4px 0;
        }

        .step-number {
            background: var(--text);
            color: white;
            width: 24px;
            height: 24px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-right: 10px;
            font-size: 0.8rem;
        }

        footer {
            text-align: center;
            margin-top: 4rem;
            color: #94a3b8;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>

    <nav>
        <div class="nav-container">
            <a href="#" class="logo">ðŸ›µ MotoRent Tutorial</a>
            <ul class="nav-links">
                <li><a href="#setup">Setup</a></li>
                <li><a href="#database">Database</a></li>
                <li><a href="#backend">Backend</a></li>
                <li><a href="#frontend">Frontend</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <header>
            <h1>Tutorial Aplikasi Rental Motor</h1>
            <p>Panduan Lengkap Pengerjaan UKK RPL 2026 dengan Laravel 12</p>
            <div>
                <span class="badge">Laravel 12</span>
                <span class="badge" style="background: #0ea5e9;">Bootstrap 5</span>
                <span class="badge" style="background: #f59e0b;">MySQL</span>
            </div>
        </header>

        <section id="intro">
            <p>Dokumen ini berisi panduan teknis langkah demi langkah untuk membangun aplikasi Rental Motor. Fokus utama tutorial ini adalah pada <strong>Logika Bisnis</strong> (Penyewaan, Pengembalian, Denda) dan <strong>Manajemen Data</strong> sesuai spesifikasi soal.</p>
        </section>

        <section id="setup">
            <h2>1. Persiapan & Instalasi</h2>
            <p>Pastikan Composer dan PHP 8.2+ sudah terinstall.</p>
            
            <h3>Langkah 1: Install Laravel</h3>
            <pre><code>composer create-project laravel/laravel rental-motor
cd rental-motor</code></pre>

            <h3>Langkah 2: Konfigurasi Database</h3>
            <p>Buka file <code>.env</code> dan sesuaikan koneksi database:</p>
            <pre><code>DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=rental_motor_db
DB_USERNAME=root
DB_PASSWORD=</code></pre>
        </section>

        <section id="database">
            <h2>2. Desain Database (Migrations)</h2>
            <p>Kita membutuhkan 3 tabel utama: <code>users</code>, <code>motors</code>, dan <code>transactions</code>.</p>

            <h3>Tabel Motors</h3>
            <p>Membuat migrasi untuk tabel motor:</p>
            <pre><code>php artisan make:migration create_motors_table</code></pre>
            <p>Edit file migrasi:</p>
            <pre><code>public function up()
{
    Schema::create('motors', function (Blueprint $table) {
        $table->id();
        $table->string('nopol', 20)->unique(); // Validasi unik
        $table->string('merk', 50);
        $table->string('jenis', 50); // Matic, Bebek, Sport
        $table->decimal('harga_sewa', 10, 2);
        $table->enum('status', ['tersedia', 'tidak_tersedia'])->default('tersedia');
        $table->timestamps();
    });
}</code></pre>

            <h3>Tabel Transactions (Peminjaman)</h3>
            <pre><code>php artisan make:migration create_transactions_table</code></pre>
            <pre><code>public function up()
{
    Schema::create('transactions', function (Blueprint $table) {
        $table->id();
        $table->foreignId('user_id')->constrained()->onDelete('cascade');
        $table->foreignId('motor_id')->constrained()->onDelete('cascade');
        $table->date('tgl_pinjam');
        $table->date('tgl_kembali')->nullable();
        $table->decimal('total_bayar', 12, 2)->nullable();
        $table->decimal('denda', 12, 2)->default(0);
        $table->enum('status', ['sewa', 'selesai'])->default('sewa');
        $table->timestamps();
    });
}</code></pre>
            
            <p>Jalankan migrasi:</p>
            <pre><code>php artisan migrate</code></pre>
        </section>

        <section id="backend">
            <h2>3. Logika Bisnis (Backend)</h2>
            
            <h3>Model Setup</h3>
            <p>Tambahkan <code>protected $guarded = [];</code> pada model <code>Motor</code> dan <code>Transaction</code> agar mass assignment bisa berjalan.</p>

            <h3>Logika Peminjaman (Store)</h3>
            <p>Saat user menyewa motor, status motor harus berubah menjadi "tidak_tersedia".</p>
            <pre><code>// TransactionController.php

public function store(Request $request)
{
    // 1. Validasi Input
    $request->validate([
        'motor_id' => 'required|exists:motors,id',
        'tgl_pinjam' => 'required|date|after_or_equal:today',
    ]);

    // 2. Cek Ketersediaan Motor (Double Check)
    $motor = Motor::find($request->motor_id);
    if($motor->status !== 'tersedia') {
        return back()->with('error', 'Motor sedang tidak tersedia!');
    }

    // 3. Buat Transaksi
    Transaction::create([
        'user_id' => auth()->id(),
        'motor_id' => $request->motor_id,
        'tgl_pinjam' => $request->tgl_pinjam,
        'status' => 'sewa'
    ]);

    // 4. Update Status Motor
    $motor->update(['status' => 'tidak_tersedia']);

    return redirect()->route('transactions.index')->with('success', 'Sewa berhasil!');
}</code></pre>

            <h3>Logika Pengembalian (Return) - Fitur Utama</h3>
            <div class="alert">
                <strong>Poin Penting:</strong> Sistem harus otomatis menghitung durasi dan total biaya. Jika sewa kurang dari 24 jam (0 hari), tetap dihitung 1 hari (Minimum Charge).
            </div>
            <pre><code>// TransactionController.php

public function complete(Request $request, Transaction $transaction)
{
    // Menggunakan Carbon untuk manipulasi tanggal
    $tglKembali = now(); // Atau input dari request
    $tglPinjam = \Carbon\Carbon::parse($transaction->tgl_pinjam);
    
    // Hitung selisih hari
    $durasi = $tglPinjam->diffInDays($tglKembali);
    
    // Logika Minimum Charge (Jika < 1 hari, hitung 1 hari)
    if ($durasi < 1) {
        $durasi = 1;
    }

    // Ambil harga sewa motor
    $hargaPerHari = $transaction->motor->harga_sewa;
    
    // Hitung Total
    $totalBayar = $durasi * $hargaPerHari;

    // Update Transaksi
    $transaction->update([
        'tgl_kembali' => $tglKembali,
        'total_bayar' => $totalBayar,
        'status' => 'selesai'
    ]);

    // Kembalikan Status Motor menjadi Tersedia
    $transaction->motor->update(['status' => 'tersedia']);

    return back()->with('success', "Pengembalian sukses. Total: Rp " . number_format($totalBayar));
}</code></pre>
        </section>

        <section id="frontend">
            <h2>4. Tampilan (Frontend)</h2>
            <p>Gunakan template <strong>SB Admin 2</strong> untuk tampilan dashboard yang profesional.</p>

            <h3>Struktur Folder View</h3>
            <ul>
                <li><code>resources/views/layouts/app.blade.php</code> (Master layout)</li>
                <li><code>resources/views/motors/index.blade.php</code> (Tabel daftar motor)</li>
                <li><code>resources/views/transactions/create.blade.php</code> (Form sewa)</li>
            </ul>

            <h3>Contoh Tabel Motor (Blade)</h3>
            <pre><code>&lt;table class="table table-bordered"&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;No Polisi&lt;/th&gt;
            &lt;th&gt;Merk&lt;/th&gt;
            &lt;th&gt;Status&lt;/th&gt;
            &lt;th&gt;Aksi&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        @foreach($motors as $motor)
        &lt;tr&gt;
            &lt;td&gt;{{ $motor->nopol }}&lt;/td&gt;
            &lt;td&gt;{{ $motor->merk }}&lt;/td&gt;
            &lt;td&gt;
                &lt;span class="badge bg-{{ $motor->status == 'tersedia' ? 'success' : 'danger' }}"&gt;
                    {{ $motor->status }}
                &lt;/span&gt;
            &lt;/td&gt;
            &lt;td&gt;
                @if($motor->status == 'tersedia')
                    &lt;a href="{{ route('sewa.create', $motor->id) }}" class="btn btn-primary btn-sm"&gt;Sewa&lt;/a&gt;
                @else
                    &lt;button class="btn btn-secondary btn-sm" disabled&gt;Disewa&lt;/button&gt;
                @endif
            &lt;/td&gt;
        &lt;/tr&gt;
        @endforeach
    &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
        </section>

        <section id="security">
            <h2>5. Keamanan & Validasi</h2>
            <ul>
                <li><strong>Authentication:</strong> Gunakan Laravel Breeze atau UI untuk Login/Register.</li>
                <li><strong>Middleware:</strong> Pastikan route admin dilindungi middleware <code>auth</code>.</li>
                <li><strong>CSRF Protection:</strong> Pastikan semua form menggunakan <code>@csrf</code>.</li>
            </ul>
        </section>

        <footer>
            <p>&copy; 2026 Tutorial UKK RPL - Dibuat untuk tujuan pembelajaran.</p>
        </footer>
    </div>

    <script>
        // Script sederhana untuk smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>
